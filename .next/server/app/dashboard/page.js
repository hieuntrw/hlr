(()=>{var e={};e.id=702,e.ids=[702],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3853:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>c}),s(9521),s(2222),s(5866);var r=s(3191),a=s(8716),n=s(7922),l=s.n(n),i=s(5231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9521)),"/workspaces/hlr/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2222)),"/workspaces/hlr/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/workspaces/hlr/app/dashboard/page.tsx"],x="/dashboard/page",h={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7016:(e,t,s)=>{Promise.resolve().then(s.bind(s,7876))},1350:(e,t,s)=>{Promise.resolve().then(s.bind(s,7553))},372:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},7876:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(326),a=s(7577),n=s(5047),l=s(6968);function i({rank:e,name:t,avatar:s,totalKm:a,pace:n,targetKm:l}){let i=Math.min(a/l*100,100);return r.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center font-bold text-white ${1===e?"bg-yellow-500":2===e?"bg-gray-400":3===e?"bg-orange-500":"bg-gray-300"}`,children:e}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center text-white font-bold",children:s||t.charAt(0).toUpperCase()})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:t}),r.jsx("p",{className:"text-sm text-gray-500",children:`${Math.floor(n/60)}:${Math.round(n%60).toString().padStart(2,"0")}/km`})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("span",{className:"font-semibold text-gray-900",children:[a," km"]}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(i),"%"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full transition-all ${i>=100?"bg-green-500":i>=75?"bg-blue-500":i>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${i}%`}})}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Mục ti\xeau: ",l," km"]})]}),a>=l&&r.jsx("div",{className:"flex-shrink-0",children:r.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"✓ Ho\xe0n th\xe0nh"})})]})})}var d=s(1579);function c(){var e;let t=(0,n.useSearchParams)().get("strava_connected"),[s,c]=(0,a.useState)([]),[o,x]=(0,a.useState)(""),[h,m]=(0,a.useState)(!0),[g,u]=(0,a.useState)(!1),[b,p]=(0,a.useState)(null),[f,j]=(0,a.useState)(null),[v,y]=(0,a.useState)({totalKm:0,avgPace:null,targetKm:0,progressPercent:0});async function N(){m(!0),x("Th\xe1ch thức th\xe1ng 11/2025"),c([{rank:1,name:"Nguyễn Hải Đăng",totalKm:285,pace:420,targetKm:300},{rank:2,name:"Trần Quốc Việt",totalKm:270,pace:450,targetKm:300},{rank:3,name:"Phạm Thị Hương",totalKm:255,pace:480,targetKm:300},{rank:4,name:"B\xf9i Anh Tuấn",totalKm:240,pace:435,targetKm:250},{rank:5,name:"L\xea Minh H\xf2a",totalKm:235,pace:465,targetKm:300},{rank:6,name:"Ho\xe0ng Minh Kh\xe1nh",totalKm:220,pace:500,targetKm:250},{rank:7,name:"Đỗ Thị Lan",totalKm:210,pace:510,targetKm:200},{rank:8,name:"Vũ Quang Huy",totalKm:195,pace:520,targetKm:250},{rank:9,name:"L\xfd Tuấn Anh",totalKm:180,pace:540,targetKm:200},{rank:10,name:"Trịnh Minh Đức",totalKm:165,pace:560,targetKm:200}]),m(!1)}async function w(){try{let e=new Date,t=e.getMonth()+1,s=e.getFullYear(),r=new Date(Date.UTC(s,t-1,1)).toISOString().slice(0,10),a=new Date(Date.UTC(s,t,0)).toISOString().slice(0,10),{data:{user:n}}=await d.O.auth.getUser();if(!n)return;let{data:l}=await d.O.from("challenges").select("id").gte("start_date",r).lte("start_date",a).limit(1).maybeSingle();if(!l)return;let{data:i}=await d.O.from("challenge_participants").select("actual_km, avg_pace_seconds, target_km").eq("challenge_id",l.id).eq("user_id",n.id).maybeSingle();if(i){let e=Number(i.actual_km)||0,t=Number(i.target_km)||0,s=Number(i.avg_pace_seconds)||0,r=s>0?`${Math.floor(s/60)}:${String(s%60).padStart(2,"0")}`:null;y({totalKm:e,avgPace:r,targetKm:t,progressPercent:t>0?Math.round(e/t*100):0})}}catch(e){console.error("Failed to fetch personal stats:",e)}}let k=async()=>{u(!0),p(null);try{let e=await fetch("/api/strava/sync",{method:"POST"});if(e.ok)await e.json(),p("Đồng bộ th\xe0nh c\xf4ng"),await N(),await w();else{let t=await e.json().catch(()=>({}));p(t?.error||"Đồng bộ thất bại")}}catch(e){p("Đồng bộ thất bại")}finally{u(!1)}};return(0,r.jsxs)(r.Fragment,{children:[r.jsx(l.Z,{}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[!f&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-blue-900",children:"Bạn chưa đăng nhập"}),r.jsx("p",{className:"text-sm text-blue-700",children:"Vui l\xf2ng đăng nhập bằng email của th\xe0nh vi\xean để kết nối Strava v\xe0 đồng bộ hoạt động."})]}),r.jsx("div",{children:r.jsx("a",{href:"/profile",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"Đăng nhập / Hồ sơ"})})]}),f&&r.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-primary-500 to-blue-500 rounded-lg text-white",children:r.jsx("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold mb-2",children:["Ch\xe0o mừng, ",f.full_name||"Runner","! \uD83C\uDFC3"]}),r.jsx("p",{className:"text-primary-100",children:f.strava_id?"Kết nối Strava đ\xe3 được thiết lập. Dữ liệu của bạn sẽ được cập nhật tự động.":"H\xe3y kết nối Strava để bắt đầu theo d\xf5i hoạt động"})]})})}),f&&!f.strava_id&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-orange-900",children:"Chưa kết nối Strava"}),r.jsx("p",{className:"text-sm text-orange-700",children:"Bạn đ\xe3 đăng nhập nhưng chưa li\xean kết t\xe0i khoản Strava. Nhấn n\xfat b\xean để bắt đầu li\xean kết (Strava OAuth)."})]}),r.jsx("div",{children:r.jsx("a",{href:"/api/auth/strava/login",className:"px-4 py-2 bg-orange-500 text-white rounded-md",children:"Kết nối Strava"})})]}),t&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:"✓"}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-green-900",children:"Kết nối Strava th\xe0nh c\xf4ng!"}),r.jsx("p",{className:"text-sm text-green-700",children:"Dữ liệu hoạt động của bạn sẽ được cập nhật tự động"})]})]}),(0,r.jsxs)("div",{className:"mb-8 bg-gradient-to-r from-primary-50 to-blue-50 rounded-lg border border-primary-200 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Thống k\xea c\xe1 nh\xe2n th\xe1ng n\xe0y"}),(0,r.jsxs)("button",{onClick:k,disabled:g,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-md hover:brightness-95 disabled:opacity-60 transition",children:[g?r.jsx("svg",{className:"w-4 h-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:r.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"rgba(255,255,255,0.6)",strokeWidth:"4"})}):r.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:r.jsx("path",{d:"M12 4v4m0 8v4M4 12h4m8 0h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),r.jsx("span",{children:g?"Đang đồng bộ...":"Đồng bộ ngay"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Tổng KM th\xe1ng n\xe0y"}),r.jsx("p",{className:"text-3xl font-bold text-primary-600",children:v.totalKm.toFixed(1)}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["/ ",v.targetKm," km"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Pace trung b\xecnh"}),r.jsx("p",{className:"text-3xl font-bold text-primary-600",children:v.avgPace||"—"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ph\xfat / km"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"% Ho\xe0n th\xe0nh"}),(0,r.jsxs)("p",{className:"text-3xl font-bold text-primary-600",children:[v.progressPercent,"%"]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"của mục ti\xeau"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Tiến độ"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[v.totalKm.toFixed(1)," / ",v.targetKm," km"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full transition-all ${(e=v.progressPercent)>=100?"bg-purple-600":e>=80?"bg-green-600":e>=50?"bg-yellow-500":"bg-red-600"}`,style:{width:`${Math.min(v.progressPercent,100)}%`}})}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:v.progressPercent>=100?"\uD83C\uDF89 Bạn đ\xe3 vượt qu\xe1 mục ti\xeau!":v.progressPercent>=80?"✓ Gần ho\xe0n th\xe0nh!":v.progressPercent>=50?"Tiếp tục cố gắng!":"Bắt đầu n\xe0o!"})]}),b&&r.jsx("p",{className:"text-sm text-gray-600 mt-4 text-center",children:b})]}),(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:o}),r.jsx("p",{className:"text-gray-600",children:"Top 10 th\xe0nh vi\xean với tiến độ ho\xe0n th\xe0nh cao nhất"})]}),h?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-gray-500",children:"Đang tải dữ liệu..."})}):r.jsx("div",{className:"space-y-3",children:s.map(e=>r.jsx(i,{...e},e.rank))}),(0,r.jsxs)("div",{className:"mt-12 grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Tổng th\xe0nh vi\xean"}),r.jsx("div",{className:"text-3xl font-bold text-gray-900",children:"10"}),r.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"đang tham gia"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Ho\xe0n th\xe0nh th\xe1ch thức"}),r.jsx("div",{className:"text-3xl font-bold text-green-600",children:"3"}),r.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"30% ho\xe0n th\xe0nh"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Tổng km chạy"}),r.jsx("div",{className:"text-3xl font-bold text-primary-600",children:"2,255"}),r.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"từ tất cả th\xe0nh vi\xean"})]})]})]})]})}function o(){return r.jsx(a.Suspense,{fallback:r.jsx("div",{className:"flex items-center justify-center h-screen",children:r.jsx("div",{className:"text-gray-500",children:"Đang tải..."})}),children:r.jsx(c,{})})}},6968:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(326);function a(){return r.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"text-2xl font-bold text-primary-600",children:"\uD83C\uDFC3"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"HLR Running Club"})]}),(0,r.jsxs)("nav",{className:"flex gap-6",children:[r.jsx("a",{href:"/dashboard",className:"text-gray-700 hover:text-primary-600 transition",children:"Bảng xếp hạng"}),r.jsx("a",{href:"/profile",className:"text-gray-700 hover:text-primary-600 transition",children:"T\xe0i khoản"}),r.jsx("a",{href:"/rules",className:"text-gray-700 hover:text-primary-600 transition",children:"Quy định"})]})]})})})}},7553:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(326),a=s(7577),n=s(434),l=s(5047);s(1579);let i=[{label:"Tổng quan",href:"/dashboard",icon:"\uD83D\uDCCA"},{label:"Bảng V\xe0ng",href:"/hall-of-fame",icon:"\uD83C\uDFC6"},{label:"Thử Th\xe1ch",href:"/challenges",icon:"\uD83C\uDFC3"},{label:"Sự Kiện",href:"/events",icon:"\uD83D\uDCC5"},{label:"Hồ Sơ",href:"/profile",icon:"\uD83D\uDC64"}],d=[{label:"Quản Trị",href:"/admin",icon:"⚙️",requiredRoles:["admin","mod_finance","mod_challenge","mod_member"]}];function c(){let e=(0,l.usePathname)(),[t,s]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null),[x,h]=(0,a.useState)(!1),m=[...i,...d.filter(e=>!e.requiredRoles||e.requiredRoles.includes(c?.role||"member"))],g=t=>e===t;return t?r.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg md:hidden",children:(0,r.jsxs)("div",{className:"flex justify-around items-center h-16",children:[m.slice(0,5).map(e=>(0,r.jsxs)(n.default,{href:e.href,className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${g(e.href)?"text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900"}`,onClick:()=>h(!1),children:[r.jsx("span",{className:"text-xl mb-1",children:e.icon}),r.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.href)),m.length>5&&(0,r.jsxs)("div",{className:"relative flex flex-col items-center justify-center flex-1 h-full",children:[(0,r.jsxs)("button",{onClick:()=>h(!x),className:`flex flex-col items-center justify-center transition-colors ${x?"text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx("span",{className:"text-xl mb-1",children:"⋯"}),r.jsx("span",{className:"text-xs font-medium",children:"More"})]}),x&&r.jsx("div",{className:"absolute bottom-full right-0 bg-white border border-gray-200 rounded-lg shadow-lg mb-2 w-40",children:m.slice(5).map(e=>(0,r.jsxs)(n.default,{href:e.href,className:`block px-4 py-2 transition-colors ${g(e.href)?"text-blue-600 bg-blue-50":"text-gray-700 hover:bg-gray-100"}`,onClick:()=>h(!1),children:[e.icon," ",e.label]},e.href))})]})]})}):(0,r.jsxs)("nav",{className:"hidden md:flex flex-col w-56 bg-white border-r border-gray-200 h-full shadow-sm sticky top-0",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[r.jsx("h1",{className:"text-2xl font-bold text-blue-600",children:"HLR Running"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Running Club"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:m.map(e=>(0,r.jsxs)(n.default,{href:e.href,className:`flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${g(e.href)?"bg-blue-100 text-blue-600 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx("span",{className:"text-xl",children:e.icon}),r.jsx("span",{children:e.label})]},e.href))}),r.jsx("div",{className:"p-4 border-t border-gray-200",children:r.jsx("div",{className:"text-sm text-gray-600",children:(0,r.jsxs)("p",{className:"font-semibold text-gray-900",children:["Role: ",r.jsx("span",{className:"text-blue-600 capitalize",children:c?.role||"member"})]})})})]})}},1579:(e,t,s)=>{"use strict";s.d(t,{O:()=>l});var r=s(7203);let a="https://jvnpxcwjfidrlqlfmuvl.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2bnB4Y3dqZmlkcmxxbGZtdXZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzODI3MTUsImV4cCI6MjA3OTk1ODcxNX0.9DQsgYHtU285oG2Twzr5mw71z4_5EiUDzry--bdf5lU";if(!a||!n)throw Error("Missing Supabase environment variables");let l=(0,r.eI)(a,n)},9521:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/workspaces/hlr/app/dashboard/page.tsx#default`)},2222:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>n});var r=s(9510);s(7272);let a=(0,s(8570).createProxy)(String.raw`/workspaces/hlr/components/Navigation.tsx#default`),n={title:"HLR Running Club",description:"Running club management system"};function l({children:e}){return r.jsx("html",{lang:"vi",children:r.jsx("body",{className:"bg-gray-50",children:(0,r.jsxs)("div",{className:"flex h-screen",children:[r.jsx(a,{}),r.jsx("main",{className:"flex-1 flex flex-col overflow-hidden",children:r.jsx("div",{className:"flex-1 overflow-y-auto pb-20 md:pb-0",children:e})})]})})})}},7272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,356],()=>s(3853));module.exports=r})();