(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[395],{9450:function(e,t,s){Promise.resolve().then(s.bind(s,1848))},1848:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(7437),r=s(2265),n=s(7648),l=s(9203);function i(e){return new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})}function c(e){let{challenge:t}=e;return(0,a.jsx)(n.default,{href:"/challenges/".concat(t.id),children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden cursor-pointer border-l-4 border-blue-500",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 flex-1",children:t.title}),t.user_participates&&(0,a.jsx)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded",children:"✓ Đ\xe3 tham gia"})]}),(0,a.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDCC5"}),(0,a.jsxs)("span",{children:[i(t.start_date)," - ",i(t.end_date)]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:"Open"===t.status?(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"}),"Đang diễn ra"]}):(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm font-semibold",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-gray-600 rounded-full"}),"Đ\xe3 đ\xf3ng"]})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Chi tiết →"}),t.is_locked&&(0,a.jsx)("span",{className:"text-xs text-red-600 font-semibold",children:"\uD83D\uDD12 Kho\xe1"})]})]})})})}function d(){let[e,t]=(0,r.useState)("all"),[s,n]=(0,r.useState)([]),[i,d]=(0,r.useState)(!0),[o,h]=(0,r.useState)(null);async function u(){let{data:{user:e}}=await l.O.auth.getUser();h((null==e?void 0:e.id)||null)}async function x(){d(!0);try{let t=l.O.from("challenges").select("id, title, start_date, end_date, password, status, is_locked, created_at").order("start_date",{ascending:!1}),{data:s,error:a}=await t;if(a){console.error("Error fetching challenges:",a),n([]);return}if(!s){n([]);return}if("my"===e&&o){let{data:e,error:t}=await l.O.from("challenge_participants").select("challenge_id").eq("user_id",o);if(t){console.error("Error fetching participations:",t),n([]);return}let a=(null==e?void 0:e.map(e=>e.challenge_id))||[],r=s.filter(e=>a.includes(e.id)).map(e=>({...e,user_participates:!0}));n(r)}else{let e=s.map(e=>({...e,user_participates:!1}));n(e)}}catch(e){console.error("Unexpected error:",e),n([])}finally{d(!1)}}return(0,r.useEffect)(()=>{u()},[]),(0,r.useEffect)(()=>{o&&x()},[e,o]),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-8 px-4",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:"\uD83C\uDFC3 Danh S\xe1ch Thử Th\xe1ch"}),(0,a.jsx)("p",{className:"text-blue-100 text-lg",children:"Tham gia c\xe1c thử th\xe1ch h\xe0ng th\xe1ng v\xe0 ho\xe0n th\xe0nh mục ti\xeau"})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex gap-2 mb-8 border-b border-gray-300",children:[(0,a.jsx)("button",{onClick:()=>t("all"),className:"px-6 py-3 font-semibold transition-all border-b-2 ".concat("all"===e?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900"),children:"\uD83D\uDCCB Tất Cả Thử Th\xe1ch"}),(0,a.jsx)("button",{onClick:()=>t("my"),className:"px-6 py-3 font-semibold transition-all border-b-2 ".concat("my"===e?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900"),children:"✓ Đ\xe3 Tham Gia"})]}),i?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Đang tải dữ liệu..."})]})}):s.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,a.jsx)(c,{challenge:e},e.id))}):(0,a.jsx)("div",{className:"bg-white rounded-lg p-12 text-center shadow-sm",children:(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"my"===e?"Bạn chưa tham gia thử th\xe1ch n\xe0o":"Chưa c\xf3 thử th\xe1ch"})})]})]})}},9203:function(e,t,s){"use strict";s.d(t,{O:function(){return l}});var a=s(7421);let r="https://jvnpxcwjfidrlqlfmuvl.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2bnB4Y3dqZmlkcmxxbGZtdXZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzODI3MTUsImV4cCI6MjA3OTk1ODcxNX0.9DQsgYHtU285oG2Twzr5mw71z4_5EiUDzry--bdf5lU";if(!r||!n)throw Error("Missing Supabase environment variables");let l=(0,a.eI)(r,n)},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)}},function(e){e.O(0,[421,972,971,117,744],function(){return e(e.s=9450)}),_N_E=e.O()}]);