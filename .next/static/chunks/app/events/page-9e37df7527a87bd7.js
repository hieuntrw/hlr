(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[38],{7970:function(e,s,t){Promise.resolve().then(t.bind(t,2998))},2998:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return d}});var a=t(7437),r=t(2265),l=t(9203);function n(e){return new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})}function i(e){return 0===e?"Huy chương":e>=1e6?"".concat((e/1e6).toFixed(1),"tr"):e>=1e3?"".concat((e/1e3).toFixed(0),"k"):"".concat(e)}function c(e){let{race:s,onClick:t}=e;return(0,a.jsxs)("div",{onClick:t,className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:[s.image_url&&(0,a.jsx)("div",{className:"relative w-full h-40 overflow-hidden bg-gray-200",children:(0,a.jsx)("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover hover:scale-105 transition-transform"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:s.name}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDCC5"}),(0,a.jsx)("span",{children:n(s.race_date)})]}),(0,a.jsxs)("p",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDCCD"}),(0,a.jsx)("span",{children:s.location||"Chưa c\xf3 th\xf4ng tin"})]})]}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,a.jsx)("span",{className:"text-sm font-semibold text-blue-600",children:"Chi tiết →"})})]})]})}function d(){let[e,s]=(0,r.useState)([]),[t,d]=(0,r.useState)(null),[o,x]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[u,g]=(0,r.useState)(!0),[p,f]=(0,r.useState)(!1);async function b(){g(!0);try{let{data:e,error:t}=await l.O.from("races").select("id, name, race_date, location, image_url").order("race_date",{ascending:!1});if(t){console.error("Error fetching races:",t);return}s(e||[])}catch(e){console.error("Unexpected error:",e)}finally{g(!1)}}async function j(e){d(e),f(!0);try{let{data:s,error:t}=await l.O.from("race_results").select("\n          id,\n          user_id,\n          distance,\n          chip_time_seconds,\n          official_rank,\n          age_group_rank,\n          is_pr,\n          profiles(full_name, avatar_url)\n        ").eq("race_id",e.id).order("chip_time_seconds",{ascending:!0});if(t){console.error("Error fetching results:",t);return}let a=(null==s?void 0:s.map(e=>({id:e.id,user_id:e.user_id,distance:e.distance,chip_time_seconds:e.chip_time_seconds,official_rank:e.official_rank,age_group_rank:e.age_group_rank,is_pr:e.is_pr,profile:e.profiles})))||[];x(a);let{data:r,error:n}=await l.O.from("reward_definitions").select("id, category, type, condition_value, condition_label, prize_description, cash_amount").order("category",{ascending:!0}).order("priority_level",{ascending:!0});if(n){console.error("Error fetching rewards:",n);return}m(r||[])}catch(e){console.error("Unexpected error:",e)}finally{f(!1)}}return((0,r.useEffect)(()=>{b()},[]),u)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Đang tải dữ liệu..."})]})}):t?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-8 px-4",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("button",{onClick:()=>{d(null),x([]),m([])},className:"text-blue-100 hover:text-white mb-4 inline-block",children:"← Quay lại"}),(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:t.name}),(0,a.jsxs)("p",{className:"text-blue-100",children:["\uD83D\uDCC5 ",n(t.race_date)," • \uD83D\uDCCD ",t.location]})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:p?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Đang tải kết quả..."})]})}):(0,a.jsxs)(a.Fragment,{children:[o.length>0&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"\uD83C\uDFC3 Kết Quả Giải Chạy"}),Array.from(new Set(o.map(e=>e.distance))).map(e=>(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4 pb-2 border-b-2 border-blue-300",children:[e," Cự Ly"]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b-2 border-gray-300 bg-gray-50",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-bold text-gray-700",children:"Xếp Hạng"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-bold text-gray-700",children:"T\xean Th\xe0nh Vi\xean"}),(0,a.jsx)("th",{className:"text-right py-3 px-4 font-bold text-gray-700",children:"Chip Time"}),(0,a.jsx)("th",{className:"text-right py-3 px-4 font-bold text-gray-700",children:"Nh\xf3m Tuổi"}),(0,a.jsx)("th",{className:"text-center py-3 px-4 font-bold text-gray-700",children:"PR"})]})}),(0,a.jsx)("tbody",{children:o.filter(s=>s.distance===e).map((e,s)=>{var t,r,l;return(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("div",{className:"flex items-center justify-center",children:0===s?(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD47"}):1===s?(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD48"}):2===s?(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD49"}):(0,a.jsxs)("span",{className:"font-bold text-gray-600",children:["#",s+1]})})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(null===(t=e.profile)||void 0===t?void 0:t.avatar_url)?(0,a.jsx)("img",{src:e.profile.avatar_url,alt:e.profile.full_name,className:"w-8 h-8 rounded-full object-cover"}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-xs",children:"\uD83D\uDC64"}),(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:null===(r=e.profile)||void 0===r?void 0:r.full_name}),e.is_pr&&(0,a.jsx)("span",{className:"ml-2 text-xl animate-pulse",children:"⭐"})]})}),(0,a.jsx)("td",{className:"py-3 px-4 text-right",children:(0,a.jsx)("span",{className:"font-bold text-blue-600",children:(l=e.chip_time_seconds,"".concat(Math.floor(l/3600).toString().padStart(2,"0"),":").concat(Math.floor(l%3600/60).toString().padStart(2,"0"),":").concat(Math.floor(l%60).toString().padStart(2,"0")))})}),(0,a.jsx)("td",{className:"py-3 px-4 text-right text-gray-600",children:e.age_group_rank?"#".concat(e.age_group_rank):"N/A"}),(0,a.jsx)("td",{className:"py-3 px-4 text-center",children:e.is_pr?(0,a.jsx)("span",{className:"text-2xl",children:"✨"}):(0,a.jsx)("span",{className:"text-gray-300",children:"-"})})]},e.id)})})]})})]},e))]}),h.length>0&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"\uD83C\uDFC6 Bảng Quy Đổi Giải Thưởng"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[h.filter(e=>"HM"===e.category).length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-blue-600 mb-4",children:"\uD83C\uDFC3 Half Marathon (21km)"}),(0,a.jsx)("div",{className:"space-y-3",children:h.filter(e=>"HM"===e.category).map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-bold text-gray-900",children:e.condition_label}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.prize_description})]}),(0,a.jsx)("div",{className:"text-right font-bold text-green-600 whitespace-nowrap",children:i(e.cash_amount)})]},e.id))})]}),h.filter(e=>"FM"===e.category).length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-purple-600 mb-4",children:"\uD83C\uDFC3 Full Marathon (42km)"}),(0,a.jsx)("div",{className:"space-y-3",children:h.filter(e=>"FM"===e.category).map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-4 p-3 border border-purple-200 rounded-lg hover:bg-purple-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-bold text-gray-900",children:e.condition_label}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.prize_description})]}),(0,a.jsx)("div",{className:"text-right font-bold text-green-600 whitespace-nowrap",children:i(e.cash_amount)})]},e.id))})]})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-6 p-4 bg-blue-50 rounded-lg",children:["\uD83D\uDCA1 ",(0,a.jsx)("strong",{children:"Hướng dẫn:"})," Tra cứu th\xe0nh t\xedch của bạn để xem m\xecnh đạt mốc n\xe0o v\xe0 sẽ nhận được giải thưởng g\xec. Những th\xe0nh t\xedch c\xf3 dấu ⭐ l\xe0 những kỷ lục c\xe1 nh\xe2n (PR)."]})]}),0===o.length&&0===h.length&&(0,a.jsx)("div",{className:"bg-white rounded-lg p-12 text-center shadow-sm",children:(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"Chưa c\xf3 dữ liệu cho sự kiện n\xe0y"})})]})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-8 px-4",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:"\uD83C\uDFC3 Danh S\xe1ch Sự Kiện Chạy"}),(0,a.jsx)("p",{className:"text-blue-100 text-lg",children:"Xem kết quả giải đấu v\xe0 nhận thưởng"})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:e.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,a.jsx)(c,{race:e,onClick:()=>j(e)},e.id))}):(0,a.jsx)("div",{className:"bg-white rounded-lg p-12 text-center shadow-sm",children:(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"Chưa c\xf3 sự kiện n\xe0o"})})})]})}},9203:function(e,s,t){"use strict";t.d(s,{O:function(){return n}});var a=t(7421);let r="https://jvnpxcwjfidrlqlfmuvl.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2bnB4Y3dqZmlkcmxxbGZtdXZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzODI3MTUsImV4cCI6MjA3OTk1ODcxNX0.9DQsgYHtU285oG2Twzr5mw71z4_5EiUDzry--bdf5lU";if(!r||!l)throw Error("Missing Supabase environment variables");let n=(0,a.eI)(r,l)}},function(e){e.O(0,[421,971,117,744],function(){return e(e.s=7970)}),_N_E=e.O()}]);