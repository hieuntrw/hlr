(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{7607:function(e,s,t){Promise.resolve().then(t.bind(t,112))},112:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return i}});var a=t(7437),r=t(2265),l=t(4196),n=t(9203);function i(){let[e,s]=(0,r.useState)(null),[t,i]=(0,r.useState)([]),[d,c]=(0,r.useState)(!0),[o,x]=(0,r.useState)(!1);function m(e){if(!e)return null;let s=Math.floor(e/3600),t=Math.floor(e%3600/60),a=e%60;return s>0?"".concat(s,":").concat(String(t).padStart(2,"0"),":").concat(String(a).padStart(2,"0")):"".concat(t,":").concat(String(a).padStart(2,"0"))}(0,r.useEffect)(()=>{!async function(){try{let{data:{user:e}}=await n.O.auth.getUser();if(!e){c(!1);return}let{data:t,error:a}=await n.O.from("profiles").select("id, full_name, email, phone_number, join_date, strava_id, pb_hm_seconds, pb_fm_seconds").eq("id",e.id).maybeSingle();if(a){console.error("Failed to load profile:",a),c(!1);return}if(!t){c(!1);return}let r={id:t.id,fullName:t.full_name||e.email||"",email:t.email||e.email||"",phoneNumber:t.phone_number||null,joinDate:t.join_date||null,isStravaConnected:!!t.strava_id,stravaId:t.strava_id||null,pbHM:t.pb_hm_seconds?m(t.pb_hm_seconds):null,pbFM:t.pb_fm_seconds?m(t.pb_fm_seconds):null};s(r),c(!1)}catch(e){console.error("Profile load error:",e),c(!1)}}()},[]);let h=async()=>{x(!0),window.location.href="/api/auth/strava/login"};return d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"text-gray-500",children:"Đang tải..."})})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-8 mb-8",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-5xl text-white font-bold",children:null==e?void 0:e.fullName.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:null==e?void 0:e.fullName}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Tham gia từ"," ",new Date((null==e?void 0:e.joinDate)||"").toLocaleDateString("vi-VN")]})]})]}),(null==e?void 0:e.isStravaConnected)?(0,a.jsx)("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsx)("span",{className:"text-green-600 font-semibold",children:"✓ Đ\xe3 kết nối Strava"})}):(0,a.jsx)("button",{onClick:h,disabled:o,className:"px-6 py-2 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-400 text-white font-semibold rounded-lg transition",children:o?"Đang kết nối...":"Kết nối Strava"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 pb-6 border-b border-gray-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Email"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:null==e?void 0:e.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Số điện thoại"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:null==e?void 0:e.phoneNumber})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Th\xe0nh t\xedch c\xe1 nh\xe2n"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Kỷ lục b\xe1n marathon (21km)"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(null==e?void 0:e.pbHM)||"—"}),(null==e?void 0:e.pbHM)&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Trung b\xecnh: ",(60*parseInt(e.pbHM.split(":")[0])+parseInt(e.pbHM.split(":")[1]))/21,":00 /km"]})]}),(0,a.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Kỷ lục marathon (42km)"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(null==e?void 0:e.pbFM)||"—"}),(null==e?void 0:e.pbFM)&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Trung b\xecnh: ",(60*parseInt(e.pbFM.split(":")[0])+parseInt(e.pbFM.split(":")[1]))/42,":00 /km"]})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Lịch sử giải đấu"}),0===t.length?(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Chưa c\xf3 kết quả giải đấu n\xe0o được ghi nhận"})}):(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.raceName}),e.isPR&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-semibold bg-yellow-100 text-yellow-800",children:"⭐ PB"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[e.distance," • ",new Date(e.date).toLocaleDateString("vi-VN")]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-gray-900",children:e.time}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.pace})]})]})},e.id))})]})]})]})}},4196:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var a=t(7437);function r(){return(0,a.jsx)("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-primary-600",children:"\uD83C\uDFC3"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"HLR Running Club"})]}),(0,a.jsxs)("nav",{className:"flex gap-6",children:[(0,a.jsx)("a",{href:"/dashboard",className:"text-gray-700 hover:text-primary-600 transition",children:"Bảng xếp hạng"}),(0,a.jsx)("a",{href:"/profile",className:"text-gray-700 hover:text-primary-600 transition",children:"T\xe0i khoản"}),(0,a.jsx)("a",{href:"/rules",className:"text-gray-700 hover:text-primary-600 transition",children:"Quy định"})]})]})})})}},9203:function(e,s,t){"use strict";t.d(s,{O:function(){return n}});var a=t(7421);let r="https://jvnpxcwjfidrlqlfmuvl.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2bnB4Y3dqZmlkcmxxbGZtdXZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzODI3MTUsImV4cCI6MjA3OTk1ODcxNX0.9DQsgYHtU285oG2Twzr5mw71z4_5EiUDzry--bdf5lU";if(!r||!l)throw Error("Missing Supabase environment variables");let n=(0,a.eI)(r,l)}},function(e){e.O(0,[421,971,117,744],function(){return e(e.s=7607)}),_N_E=e.O()}]);