(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[977],{7852:function(e,t,s){Promise.resolve().then(s.bind(s,8443))},8443:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),r=s(2265),n=s(9376),l=s(7648),d=s(9203);function i(e){return new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})}function c(){let e=(0,n.useRouter)(),[t,s]=(0,r.useState)([]),[c,o]=(0,r.useState)(!0),[h,x]=(0,r.useState)(!1),[u,m]=(0,r.useState)({title:"",start_date:"",end_date:""});async function g(){let{data:{user:t}}=await d.O.auth.getUser();if(!t){e.push("/debug-login");return}let{data:s}=await d.O.from("profiles").select("role").eq("id",t.id).single();(null==s?void 0:s.role)&&["admin","mod_challenge"].includes(s.role)||e.push("/")}async function b(){o(!0);try{let{data:e,error:t}=await d.O.from("challenges").select("id, title, start_date, end_date, status, is_locked").order("start_date",{ascending:!1});if(t){console.error("Error:",t);return}s(e||[])}catch(e){console.error("Error:",e)}finally{o(!1)}}async function p(e){if(e.preventDefault(),!u.title||!u.start_date||!u.end_date){alert("Vui l\xf2ng điền đầy đủ th\xf4ng tin");return}try{let{error:e}=await d.O.from("challenges").insert({title:u.title,start_date:u.start_date,end_date:u.end_date,password:Math.random().toString(36).substring(7)});if(e){console.error("Error:",e),alert("Lỗi khi tạo thử th\xe1ch");return}alert("Tạo thử th\xe1ch th\xe0nh c\xf4ng!"),m({title:"",start_date:"",end_date:""}),x(!1),b()}catch(e){console.error("Error:",e),alert("C\xf3 lỗi xảy ra")}}return(0,r.useEffect)(()=>{g(),b()},[]),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-6 px-4",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"\uD83C\uDFC3 Tạo/Sửa Thử Th\xe1ch"}),(0,a.jsx)(l.default,{href:"/admin",className:"text-blue-100 hover:text-white",children:"← Quay lại"})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("button",{onClick:()=>x(!h),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors",children:h?"✕ Đ\xf3ng Form":"➕ Tạo Thử Th\xe1ch Mới"})}),h&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Tạo Thử Th\xe1ch Mới"}),(0,a.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"T\xean Thử Th\xe1ch"}),(0,a.jsx)("input",{type:"text",value:u.title,onChange:e=>m({...u,title:e.target.value}),placeholder:"VD: Th\xe1ng 12 - 300km Challenge",className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Ng\xe0y Bắt Đầu"}),(0,a.jsx)("input",{type:"date",value:u.start_date,onChange:e=>m({...u,start_date:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Ng\xe0y Kết Th\xfac"}),(0,a.jsx)("input",{type:"date",value:u.end_date,onChange:e=>m({...u,end_date:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-2 rounded-lg transition-colors",children:"Tạo Thử Th\xe1ch"}),(0,a.jsx)("button",{type:"button",onClick:()=>x(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-900 font-bold py-2 rounded-lg transition-colors",children:"Hủy"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-x-auto",children:c?(0,a.jsx)("div",{className:"p-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Đang tải..."})}):t.length>0?(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b-2 border-gray-300 bg-gray-50",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-bold text-gray-700",children:"T\xean Thử Th\xe1ch"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-bold text-gray-700",children:"Ng\xe0y Bắt Đầu"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-bold text-gray-700",children:"Ng\xe0y Kết Th\xfac"}),(0,a.jsx)("th",{className:"text-center py-3 px-4 font-bold text-gray-700",children:"Trạng Th\xe1i"}),(0,a.jsx)("th",{className:"text-center py-3 px-4 font-bold text-gray-700",children:"Kh\xf3a"}),(0,a.jsx)("th",{className:"text-center py-3 px-4 font-bold text-gray-700",children:"H\xe0nh Động"})]})}),(0,a.jsx)("tbody",{children:t.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4 font-semibold",children:e.title}),(0,a.jsx)("td",{className:"py-3 px-4",children:i(e.start_date)}),(0,a.jsx)("td",{className:"py-3 px-4",children:i(e.end_date)}),(0,a.jsx)("td",{className:"py-3 px-4 text-center",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 rounded-full text-xs font-semibold ".concat("Open"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:"Open"===e.status?"\uD83D\uDFE2 Mở":"\uD83D\uDD34 Đ\xf3ng"})}),(0,a.jsx)("td",{className:"py-3 px-4 text-center",children:e.is_locked?(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDD12"}):(0,a.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,a.jsx)("td",{className:"py-3 px-4 text-center",children:(0,a.jsx)(l.default,{href:"/challenges/".concat(e.id),className:"text-blue-600 hover:text-blue-800 font-semibold",children:"Xem"})})]},e.id))})]}):(0,a.jsx)("div",{className:"p-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Kh\xf4ng c\xf3 thử th\xe1ch n\xe0o"})})})]})]})}},9203:function(e,t,s){"use strict";s.d(t,{O:function(){return l}});var a=s(7421);let r="https://jvnpxcwjfidrlqlfmuvl.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2bnB4Y3dqZmlkcmxxbGZtdXZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzODI3MTUsImV4cCI6MjA3OTk1ODcxNX0.9DQsgYHtU285oG2Twzr5mw71z4_5EiUDzry--bdf5lU";if(!r||!n)throw Error("Missing Supabase environment variables");let l=(0,a.eI)(r,n)},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[421,972,971,117,744],function(){return e(e.s=7852)}),_N_E=e.O()}]);